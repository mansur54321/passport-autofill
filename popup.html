<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body { 
      width: 380px; 
      min-height: 450px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
      background: #f5f7fa; 
    }
    
    /* Tabs */
    .tabs {
      display: flex;
      background: linear-gradient(135deg, #366383 0%, #2d5270 100%);
    }
    
    .tab {
      flex: 1;
      padding: 12px 8px;
      text-align: center;
      color: rgba(255,255,255,0.7);
      cursor: pointer;
      font-size: 12px;
      font-weight: 600;
      border-bottom: 3px solid transparent;
      transition: all 0.2s;
    }
    
    .tab:hover { color: #fff; background: rgba(255,255,255,0.1); }
    .tab.active { color: #fff; border-bottom-color: #4fc3f7; }
    
    .tab-content { display: none; padding: 15px; }
    .tab-content.active { display: block; }
    
    h3 { 
      margin: 0 0 12px 0; 
      color: #366383; 
      font-size: 15px; 
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    h3::before {
      content: '';
      width: 4px;
      height: 16px;
      background: #366383;
      border-radius: 2px;
    }
    
    /* Form elements */
    .form-group { margin-bottom: 12px; }
    
    label { 
      display: block; 
      font-size: 11px; 
      margin-bottom: 4px; 
      font-weight: 600; 
      color: #555;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    input, select { 
      width: 100%; 
      padding: 10px 12px;
      border: 2px solid #e0e5ec;
      border-radius: 8px;
      font-size: 13px;
      transition: all 0.2s;
      background: #fff;
    }
    
    input:focus, select:focus {
      outline: none;
      border-color: #366383;
      box-shadow: 0 0 0 3px rgba(54,99,131,0.1);
    }
    
    input.error { border-color: #ef5350; background: #ffebee; }
    input.success { border-color: #66bb6a; background: #e8f5e9; }
    input.warning { border-color: #ffa726; background: #fff3e0; }
    
    .field-hint {
      font-size: 10px;
      color: #888;
      margin-top: 3px;
    }
    
    .field-error {
      font-size: 11px;
      color: #d32f2f;
      margin-top: 4px;
      display: none;
      font-weight: 500;
    }
    
    .field-error.show { display: block; }
    
    /* Buttons */
    button { 
      width: 100%; 
      padding: 10px 16px;
      background: #366383;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      font-size: 13px;
      transition: all 0.2s;
    }
    
    button:hover { background: #2d5270; transform: translateY(-1px); }
    button:active { transform: translateY(0); }
    button:disabled { background: #adb5bd; cursor: not-allowed; transform: none; }
    
    button.secondary { background: #78909c; }
    button.secondary:hover { background: #607d8b; }
    
    button.success { background: #43a047; }
    button.success:hover { background: #388e3c; }
    
    /* Checkbox */
    .checkbox-group {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
      padding: 8px;
      background: #fff;
      border-radius: 8px;
      border: 1px solid #e0e5ec;
    }
    
    .checkbox-group input[type="checkbox"] {
      width: 18px;
      height: 18px;
      margin-right: 10px;
    }
    
    .checkbox-group label {
      margin: 0;
      font-weight: normal;
      cursor: pointer;
      text-transform: none;
    }
    
    /* Messages */
    .msg { 
      font-size: 12px;
      padding: 10px;
      border-radius: 8px;
      margin-top: 10px;
      display: none;
    }
    
    .msg.success { background: #d4edda; color: #155724; display: block; }
    .msg.error { background: #f8d7da; color: #721c24; display: block; }
    .msg.info { background: #e3f2fd; color: #1565c0; display: block; }
    
    /* Update section */
    .update-status {
      padding: 10px;
      border-radius: 8px;
      font-size: 12px;
      margin-top: 10px;
      display: none;
    }
    
    .update-status.checking { display: block; background: #fff3cd; color: #856404; }
    .update-status.available { display: block; background: #d4edda; color: #155724; }
    .update-status.uptodate { display: block; background: #e3f2fd; color: #1565c0; }
    .update-status.error { display: block; background: #f8d7da; color: #721c24; }
    
    /* Version info */
    .version-info {
      margin-top: 15px;
      padding-top: 10px;
      border-top: 1px solid #e0e5ec;
      font-size: 11px;
      color: #888;
      text-align: center;
    }
    
    .version-info a { color: #366383; text-decoration: none; }
    .version-info a:hover { text-decoration: underline; }
    
    /* History */
    .history-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .history-stats { font-size: 11px; color: #888; }
    
    .history-list {
      max-height: 320px;
      overflow-y: auto;
    }
    
    .history-item {
      background: #fff;
      border-radius: 10px;
      padding: 12px;
      margin-bottom: 8px;
      border: 1px solid #e0e5ec;
      transition: all 0.2s;
    }
    
    .history-item:hover { border-color: #366383; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
    
    .history-item-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    
    .history-item-site {
      font-weight: 600;
      color: #366383;
      font-size: 12px;
    }
    
    .history-item-time {
      font-size: 10px;
      color: #999;
    }
    
    .history-item-data {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 4px 12px;
      font-size: 11px;
    }
    
    .history-item-data dt { color: #888; }
    .history-item-data dd { color: #333; font-weight: 500; }
    
    .history-item-status {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 10px;
      font-weight: 600;
      margin-top: 8px;
    }
    
    .history-item-status.success { background: #e8f5e9; color: #2e7d32; }
    .history-item-status.warning { background: #fff3e0; color: #ef6c00; }
    .history-item-status.error { background: #ffebee; color: #c62828; }
    
    .history-empty {
      text-align: center;
      padding: 40px;
      color: #aaa;
    }
    
    .history-empty-icon { font-size: 40px; margin-bottom: 10px; }
    
    /* Tools */
    .tool-panel {
      background: #fff;
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 12px;
      border: 1px solid #e0e5ec;
    }
    
    .tool-panel h4 {
      font-size: 13px;
      color: #333;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .tool-result {
      padding: 12px;
      border-radius: 8px;
      font-size: 12px;
      margin-top: 10px;
      display: none;
    }
    
    .tool-result.show { display: block; }
    .tool-result.success { background: #e8f5e9; color: #2e7d32; border: 1px solid #a5d6a7; }
    .tool-result.error { background: #ffebee; color: #c62828; border: 1px solid #ef9a9a; }
    .tool-result.warning { background: #fff3e0; color: #ef6c00; border: 1px solid #ffcc80; }
    .tool-result.info { background: #e3f2fd; color: #1565c0; border: 1px solid #90caf9; }
    
    .tool-result-title {
      font-weight: 600;
      margin-bottom: 6px;
    }
    
    .tool-result-data {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 4px 12px;
    }
    
    .tool-result-data dt { color: #666; }
    .tool-result-data dd { font-weight: 500; }
    
    .btn-row {
      display: flex;
      gap: 8px;
    }
    
    .btn-row button { flex: 1; }
    
    .copy-btn {
      padding: 6px 10px;
      background: #f5f7fa;
      border: 1px solid #e0e5ec;
      border-radius: 6px;
      cursor: pointer;
      font-size: 11px;
      color: #666;
      width: auto;
    }
    
    .copy-btn:hover { background: #e0e5ec; }
    
    /* Quick actions */
    .quick-actions {
      background: #fff;
      border-radius: 12px;
      padding: 12px;
      border: 1px solid #e0e5ec;
      margin-bottom: 12px;
    }
    
    .quick-actions h4 {
      font-size: 12px;
      color: #666;
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .quick-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      width: 100%;
      padding: 10px;
      background: #f8f9fa;
      border: 1px solid #e0e5ec;
      border-radius: 8px;
      font-size: 12px;
      color: #333;
      cursor: pointer;
      margin-bottom: 6px;
      text-align: left;
    }
    
    .quick-btn:last-child { margin-bottom: 0; }
    .quick-btn:hover { background: #e9ecef; }
    .quick-btn-icon { font-size: 16px; }
    
    /* Tips */
    .tips-box {
      background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%);
      border-radius: 12px;
      padding: 12px;
      border: 1px solid #ffe082;
    }
    
    .tips-box h4 {
      font-size: 12px;
      color: #f57c00;
      margin-bottom: 8px;
    }
    
    .tips-box ul {
      margin: 0;
      padding-left: 16px;
      font-size: 11px;
      color: #666;
    }
    
    .tips-box li { margin-bottom: 4px; }
    
    /* Currency Rates */
    .currency-rates {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
    }
    
    .currency-item {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 10px;
      text-align: center;
      border: 1px solid #e0e5ec;
    }
    
    .currency-item-code {
      font-weight: 700;
      color: #366383;
      font-size: 14px;
    }
    
    .currency-item-rate {
      font-size: 16px;
      color: #333;
      margin-top: 4px;
    }
    
    .currency-loading {
      grid-column: 1 / -1;
      text-align: center;
      padding: 20px;
      color: #888;
    }
    
    .currency-error {
      grid-column: 1 / -1;
      text-align: center;
      padding: 20px;
      color: #c62828;
    }
    
    .currency-date {
      grid-column: 1 / -1;
      font-size: 10px;
      color: #888;
      text-align: center;
      margin-top: 5px;
    }
    
    /* Quick Convert */
    .quick-convert {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    
    .quick-convert-row {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .qc-currency {
      width: 40px;
      font-weight: 700;
      color: #366383;
      font-size: 12px;
    }
    
    .qc-input {
      flex: 1;
      padding: 8px 10px !important;
      font-size: 13px !important;
    }
    
    .qc-result {
      min-width: 100px;
      font-size: 12px;
      font-weight: 600;
      color: #2e7d32;
      text-align: right;
    }
    
    /* Section divider */
    .section-title {
      font-size: 11px;
      color: #888;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin: 15px 0 10px 0;
      padding-bottom: 5px;
      border-bottom: 1px solid #e0e5ec;
    }
  </style>
</head>
<body>
  <div class="tabs">
    <div class="tab active" data-tab="settings">Settings</div>
    <div class="tab" data-tab="history">History</div>
    <div class="tab" data-tab="tools">Tools</div>
    <div class="tab" data-tab="price">Price</div>
  </div>
  
  <!-- Settings Tab -->
  <div id="settings" class="tab-content active">
    <h3>Default Settings</h3>
    
    <div class="form-group">
      <label for="email">Email</label>
      <input type="email" id="email" placeholder="agent@mail.ru">
      <div id="email-error" class="field-error"></div>
    </div>
    
    <div class="form-group">
      <label for="phone">Phone</label>
      <input type="text" id="phone" placeholder="7771234567">
      <div class="field-hint">10-12 digits without spaces</div>
      <div id="phone-error" class="field-error"></div>
    </div>

    <div class="checkbox-group">
      <input type="checkbox" id="autoFill">
      <label for="autoFill">Auto-fill without preview</label>
    </div>
    
    <button id="saveBtn">Save Settings</button>
    <div id="msg" class="msg"></div>
    
    <div class="section-title">Updates</div>
    
    <button id="checkUpdateBtn" class="secondary">Check for Updates</button>
    <div id="updateStatus" class="update-status"></div>
    
    <div class="version-info">
      Version <span id="version">-</span> | 
      <a href="https://github.com/mansur54321/passport-autofill/releases" target="_blank">Releases</a>
    </div>
  </div>
  
  <!-- History Tab -->
  <div id="history" class="tab-content">
    <div class="history-header">
      <h3>Fill History</h3>
      <div class="history-stats"><span id="historyCount">0</span> operations</div>
    </div>
    
    <div id="historyList" class="history-list">
      <div class="history-empty">
        <div class="history-empty-icon">üìã</div>
        <div>No history yet</div>
      </div>
    </div>
    
    <div class="btn-row" style="margin-top:12px;">
      <button id="exportHistoryBtn" class="secondary">Export CSV</button>
      <button id="clearHistoryBtn" class="secondary" style="background:#ef5350;">Clear</button>
    </div>
  </div>
  
  <!-- Tools Tab -->
  <div id="tools" class="tab-content">
    <h3>Travel Agent Tools</h3>
    
    <!-- IIN Validator -->
    <div class="tool-panel">
      <h4>üîç IIN Validator</h4>
      <div class="form-group">
        <label for="iinInput">IIN (12 digits)</label>
        <input type="text" id="iinInput" placeholder="000000000000" maxlength="12">
      </div>
      <button id="validateIinBtn">Validate IIN</button>
      <div id="iinResult" class="tool-result"></div>
    </div>
    
    <!-- Passport Checker -->
    <div class="tool-panel">
      <h4>üõÇ Passport Validity</h4>
      <div class="form-group">
        <label for="passportExpiry">Expiry Date</label>
        <input type="text" id="passportExpiry" placeholder="DD.MM.YYYY">
      </div>
      <button id="checkPassportBtn">Check Validity</button>
      <div id="passportResult" class="tool-result"></div>
    </div>
    
    <!-- Age Calculator -->
    <div class="tool-panel">
      <h4>üéÇ Age Calculator</h4>
      <div class="form-group">
        <label for="birthDateInput">Birth Date</label>
        <input type="text" id="birthDateInput" placeholder="DD.MM.YYYY">
      </div>
      <button id="calcAgeBtn">Calculate Age</button>
      <div id="ageResult" class="tool-result"></div>
    </div>
    
    <!-- Transliteration -->
    <div class="tool-panel">
      <h4>üî§ Transliteration</h4>
      <div class="form-group">
        <label for="cyrillicInput">Cyrillic Text</label>
        <input type="text" id="cyrillicInput" placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω">
      </div>
      <button id="translitBtn">Transliterate</button>
      <div id="translitResult" class="tool-result"></div>
    </div>
    
    <!-- Quick Actions -->
    <div class="quick-actions">
      <h4>Quick Actions</h4>
      <button class="quick-btn" id="copyEmailBtn">
        <span class="quick-btn-icon">üìß</span>
        <span>Copy default email</span>
      </button>
      <button class="quick-btn" id="copyPhoneBtn">
        <span class="quick-btn-icon">üì±</span>
        <span>Copy default phone</span>
      </button>
    </div>
    
    <!-- Tips -->
    <div class="tips-box">
      <h4>üí° Tips</h4>
      <ul>
        <li>Passport must be valid 6+ months after trip</li>
        <li>IIN contains birth date and gender info</li>
        <li>CHD = Child (2-17), INF = Infant (0-2)</li>
      </ul>
    </div>
  </div>
  
  <!-- Price Monitor Tab -->
  <div id="price" class="tab-content">
    <h3>Price Monitor</h3>
    
    <!-- Currency Rates -->
    <div class="tool-panel">
      <h4>üí± Currency Rates (FUN&SUN)</h4>
      <div id="currencyRates" class="currency-rates">
        <div class="currency-loading">Loading rates...</div>
      </div>
      <button id="refreshRatesBtn" class="secondary" style="margin-top:10px;">Refresh Rates</button>
    </div>
    
    <!-- Price Calculator -->
    <div class="tool-panel">
      <h4>üßÆ Price Calculator</h4>
      <div class="form-group">
        <label for="priceInput">Price</label>
        <input type="text" id="priceInput" placeholder="1000">
      </div>
      <div class="form-group">
        <label for="currencyFrom">From</label>
        <select id="currencyFrom">
          <option value="USD">USD</option>
          <option value="EUR">EUR</option>
          <option value="RUB">RUB</option>
          <option value="UZS">UZS</option>
          <option value="KGS">KGS</option>
          <option value="AZN">AZN</option>
        </select>
      </div>
      <button id="calcPriceBtn">Convert to KZT</button>
      <div id="priceResult" class="tool-result"></div>
    </div>
    
    <!-- Quick Convert -->
    <div class="quick-actions">
      <h4>Quick Convert to KZT</h4>
      <div class="quick-convert">
        <div class="quick-convert-row">
          <span class="qc-currency">USD</span>
          <input type="number" id="quickUSD" placeholder="0" class="qc-input">
          <span class="qc-result" id="quickUSDResult">= 0 KZT</span>
        </div>
        <div class="quick-convert-row">
          <span class="qc-currency">EUR</span>
          <input type="number" id="quickEUR" placeholder="0" class="qc-input">
          <span class="qc-result" id="quickEURResult">= 0 KZT</span>
        </div>
        <div class="quick-convert-row">
          <span class="qc-currency">RUB</span>
          <input type="number" id="quickRUB" placeholder="0" class="qc-input">
          <span class="qc-result" id="quickRUBResult">= 0 KZT</span>
        </div>
      </div>
    </div>
    
    <div class="tips-box">
      <h4>‚ÑπÔ∏è Info</h4>
      <ul>
        <li>Rates from fstravel.asia main page</li>
        <li>Updated automatically on page load</li>
        <li>For reference only - confirm with B2B</li>
      </ul>
    </div>
  </div>

  <script src="popup.js"></script>
</body>
</html>
